
================================================================================
  MULTIPOLE EXPANSION WITH SYMBOLICA
================================================================================


This package implements generic multipole moment calculations using pure Symbolica.

The multipole expansion decomposes the potential
    φ(x) = 1/|x - x_a|
    
into a series
    φ(x) = φ^(0) + φ^(1) + φ^(2) + ...

where each term captures different geometric features of the source distribution.

We implement TWO equivalent formulations:
    1. Taylor expansion: φ^(n) = ((-1)^n/n!) x_a^{i₁}...x_a^{iₙ} ∂^n/∂x^{i₁}...∂x^{iₙ}(1/r)
    2. Q tensor form: φ^(n) = (1/n!) Q^{i₁...iₙ} n^{i₁}...n^{iₙ} / r^{n+1}

And verify they are equivalent.

See the phi_from_Q function in `multipole_expansion/multipole_moments.py` for the 2nd formulation,
and the phi_n function in `multipole_expansion/taylor_expansion.py` for the 1st formulation.

Detailed explanation can be found at `report/main.pdf`.

The output formulae below are generated by code, not hard-wired text. See run_demo.py for details.

Initializing multipole expansion framework...
✓ Initialization complete

======================================================================
MULTIPOLE EXPANSION COMPUTATION
======================================================================

1. TAYLOR EXPANSION FORMULATION
----------------------------------------------------------------------
Monopole: φ^(0) = r0^-1
Dipole: φ^(1) = r0^-2*dot(xa,n)
Quadrupole: φ^(2) = -1/2*r0^-3*ra0^2+3/2*r0^-3*dot(xa,n)^2
Octupole: φ^(3) = 5/2*r0^-4*dot(xa,n)^3-3/2*r0^-4*ra0^2*dot(xa,n)

2. Q TENSOR FORMULATION
----------------------------------------------------------------------
Monopole:
  Q^{...} = 1
  φ^(0) = r0^-1
Dipole:
  Q^{...} = xa(i1)
  φ^(1) = r0^-2*dot(xa,n)
Quadrupole:
  Q^{...} = -ra0^2*delta(i1,i2)+3*xa(i1)*xa(i2)
  φ^(2) = -1/2*r0^-3*ra0^2+3/2*r0^-3*dot(xa,n)^2
Octupole:
  Q^{...} = -3*ra0^2*(xa(i1)*delta(i2,i3)+xa(i2)*delta(i1,i3)+xa(i3)*delta(i1,i2))+15*xa(i1)*xa(i2)*xa(i3)
  φ^(3) = 5/2*r0^-4*dot(xa,n)^3-3/2*r0^-4*ra0^2*dot(xa,n)

3. SPHERICAL HARMONICS FORMULATION
----------------------------------------------------------------------
======================================================================
SPHERICAL MULTIPOLE MOMENTS
======================================================================

l = 0 (monopole):
----------------------------------------------------------------------
  q_{0,+0} = 1


l = 1 (dipole):
----------------------------------------------------------------------
  q_{1,-1} = xa(x)-I*xa(y)
  q_{1,+0} = xa(z)
  q_{1,+1} = -(xa(x)+I*xa(y))


l = 2 (quadrupole):
----------------------------------------------------------------------
  q_{2,-2} = (xa(x)-I*xa(y))^2
  q_{2,-1} = (xa(x)-I*xa(y))*xa(z)
  q_{2,+0} = -xa(x)^2-xa(y)^2+2*xa(z)^2
  q_{2,+1} = -(xa(x)+I*xa(y))*xa(z)
  q_{2,+2} = (xa(x)+I*xa(y))^2


4. VERIFICATION
----------------------------------------------------------------------
======================================================================
MULTIPOLE EXPANSION VERIFICATION
======================================================================

======================================================================
ORDER n = 0
======================================================================
n=0: Monopole is trivially symmetric (scalar)
n=0: Traceless property only applies for n >= 2

n=0: Verifying equivalence of formulations
============================================================
φ^(0) from Taylor expansion:
  r0^-1

φ^(0) from Q tensor formulation:
  r0^-1

Difference (should be 0):
  0
✓ Formulations are equivalent

======================================================================
ORDER n = 1
======================================================================
n=1: Dipole is trivially symmetric (vector)
n=1: Traceless property only applies for n >= 2

n=1: Verifying equivalence of formulations
============================================================
φ^(1) from Taylor expansion:
  r0^-2*dot(xa,n)

φ^(1) from Q tensor formulation:
  r0^-2*dot(xa,n)

Difference (should be 0):
  0
✓ Formulations are equivalent

======================================================================
ORDER n = 2
======================================================================

n=2: Checking symmetry of Q tensor
Q^{12} = -ra0^2*delta(i1,i2)+3*xa(i1)*xa(i2)

Q^{ij} = -ra0^2*delta(i1,i2)+3*xa(i1)*xa(i2)
Q^{ji} = -ra0^2*delta(i2,i1)+3*xa(i1)*xa(i2)
✓ Quadrupole is symmetric (delta and products are symmetric)

n=2: Checking traceless property
Q^{} = 3*xa(i)^2-ra0^2*delta(i,i)
After contraction: 0
✓ Traceless property verified

n=2: Verifying equivalence of formulations
============================================================
φ^(2) from Taylor expansion:
  -1/2*r0^-3*ra0^2+3/2*r0^-3*dot(xa,n)^2

φ^(2) from Q tensor formulation:
  -1/2*r0^-3*ra0^2+3/2*r0^-3*dot(xa,n)^2

Difference (should be 0):
  0
✓ Formulations are equivalent

======================================================================
VERIFICATION COMPLETE
======================================================================

================================================================================
  DETAILED EXAMPLE: Quadrupole Term
================================================================================

The quadrupole (n=2) is particularly interesting.
Let's examine it in detail:

1. Cartesian Q tensor:
   Q^{ij} = -ra0^2*delta(i,j)+3*xa(i)*xa(j)
   This is symmetric: Q^{ij} = Q^{ji}
   And traceless: Q^{ii} = 0

2. Specific components (using i,j = x,y,z):
   Q^{xx}   = 3*xa(x)^2-ra0^2*delta(x,x)
   Q^{xy}   = -ra0^2*delta(x,y)+3*xa(x)*xa(y)
   Q^{xz}   = -ra0^2*delta(x,z)+3*xa(x)*xa(z)
   Q^{yy}   = 3*xa(y)^2-ra0^2*delta(y,y)
   Q^{yz}   = -ra0^2*delta(y,z)+3*xa(y)*xa(z)
   Q^{zz}   = 3*xa(z)^2-ra0^2*delta(z,z)

3. Quadrupole potential:
   φ^(2) = -1/2*r0^-3*ra0^2+3/2*r0^-3*dot(xa,n)^2
   This is (3(x_a·n)² - x_a²)/(2r³)

4. Spherical representation:
   Converting to spherical harmonics basis:
   q_{2,-2} = (xa(x)-I*xa(y))^2
   q_{2,-1} = (xa(x)-I*xa(y))*xa(z)
   q_{2,+0} = -xa(x)^2-xa(y)^2+2*xa(z)^2
   q_{2,+1} = -(xa(x)+I*xa(y))*xa(z)
   q_{2,+2} = (xa(x)+I*xa(y))^2

================================================================================
  SUMMARY
================================================================================


✓ Successfully implemented multipole expansion in pure Symbolica
✓ Verified all theoretical properties
✓ Demonstrated both Cartesian and spherical representations

This implementation can be used for:
  - Electrostatics problems
  - Gravitational potentials  
  - Quantum mechanics (angular momentum)
  - Molecular physics
  - Any system with 1/r potentials!

For more details, see:
  - README.md for theory
  - multipole_expansion/ for implementation
  - examples/ for more demonstrations
    
================================================================================
Demo complete! Thank you for using the Multipole Expansion package.
================================================================================
